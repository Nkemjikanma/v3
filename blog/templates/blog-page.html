{% extends "base.html" %}

{% block title %}{{ page.title }} - {{ config.title }}{% endblock title %}

{% block description %}{{ page.description | default(value="") }}{% endblock description %}

{% block canonical %}{{ page.permalink }}{% endblock canonical %}

{% block og_type %}article{% endblock og_type %}
{% block og_url %}{{ page.permalink }}{% endblock og_url %}
{% block og_title %}{{ page.title }}{% endblock og_title %}
{% block og_description %}{{ page.description | default(value="") }}{% endblock og_description %}
{% block og_image %}{% if page.extra.image %}<meta property="og:image" content="{{ get_url(path=page.extra.image) }}" />{% endif %}{% endblock og_image %}

{% block twitter_title %}{{ page.title }}{% endblock twitter_title %}
{% block twitter_description %}{{ page.description | default(value="") }}{% endblock twitter_description %}
{% block twitter_image %}{% if page.extra.image %}<meta name="twitter:image" content="{{ get_url(path=page.extra.image) }}" /><meta name="twitter:card" content="summary_large_image" />{% endif %}{% endblock twitter_image %}

{% block structured_data %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "{{ page.title }}",
  "description": "{{ page.description | default(value="") }}",
  "url": "{{ page.permalink }}",
  {% if page.extra.image %}"image": "{{ get_url(path=page.extra.image) }}",{% endif %}
  "datePublished": "{{ page.date | date(format="%Y-%m-%d") }}",
  {% if page.updated %}"dateModified": "{{ page.updated | date(format="%Y-%m-%d") }}",{% endif %}
  "author": {
    "@type": "Person",
    "name": "{{ config.author | default(value="Nkemjika Ohanyere") }}"
  },
  "publisher": {
    "@type": "Person",
    "name": "{{ config.author | default(value="Nkemjika Ohanyere") }}"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "{{ page.permalink }}"
  }
}
</script>
{% endblock structured_data %}

{% block content %}
<div class="progress-bar" id="progress-bar"></div>

<article class="post">
  <a href="{{ get_url(path='/') }}" class="back-link">← Back to posts</a>

  <header>
    <h1>{{ page.title }}</h1>
    <p class="post-meta">
      {{ page.date | date(format="%B %d, %Y") }}
      {% if page.reading_time %}
       · {{ page.reading_time }} min read
      {% endif %}
    </p>
  </header>

  <div class="post-content">
    {{ page.content | safe }}
  </div>
</article>

<script>
  const progressBar = document.getElementById('progress-bar');

  function updateProgress() {
    const scrollTop = window.scrollY;
    const docHeight = document.documentElement.scrollHeight - window.innerHeight;
    const progress = docHeight > 0 ? (scrollTop / docHeight) * 100 : 0;
    progressBar.style.width = progress + '%';
  }

  window.addEventListener('scroll', updateProgress, { passive: true });
  updateProgress();
</script>
{% endblock content %}
